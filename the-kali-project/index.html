<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="The Kali Project - Asistente personal con IA en Raspberry Pi 5, OpenClaw, OVOS y modelos GPT-5.3-codex + backups." />
  <title>The Kali Project - Tu Asistente Personal IA</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#1a1a2e;
      --bg2:#16213e;
      --c1:#4facfe;
      --c2:#00f2fe;
      --c3:#bd93f9;
      --txt:#e0e0e0;
      --muted:#a0a0a0;
      --muted2:#99aaff;
      --card: rgba(26, 26, 46, 0.70);
      --card2: rgba(26, 26, 46, 0.92);
      --stroke: rgba(77, 123, 245, 0.22);
      --stroke2: rgba(77, 123, 245, 0.32);
    }

    *{ margin:0; padding:0; box-sizing:border-box; }

    html{ scroll-behavior:smooth; }

    body{
      font-family:'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
      color: var(--txt);
      min-height:100vh;
      position:relative;
      overflow-x:hidden;
      line-height:1.6;
    }

    /* Canvas JS s√∫per sutil (detr√°s de todo) */
    #bg-canvas{
      position:fixed;
      inset:0;
      width:100%;
      height:100%;
      z-index:-3;
      pointer-events:none;
      opacity:0.65;
    }

    /* Fondo de part√≠culas sutiles (CSS) */
    body::before{
      content:'';
      position:fixed; inset:0;
      background-image:
        radial-gradient(2px 2px at 20px 30px, rgba(77, 123, 245, 0.26), transparent),
        radial-gradient(2px 2px at 40px 70px, rgba(0, 242, 254, 0.16), transparent),
        radial-gradient(1px 1px at 90px 40px, rgba(77, 123, 245, 0.22), transparent),
        radial-gradient(1px 1px at 130px 80px, rgba(0, 242, 254, 0.22), transparent),
        radial-gradient(2px 2px at 160px 120px, rgba(77, 123, 245, 0.16), transparent);
      background-size: 220px 220px;
      background-repeat: repeat;
      opacity: 0.42;
      animation: particleFloat 70s linear infinite;
      z-index:-2;
      pointer-events:none;
    }
    @keyframes particleFloat{
      0%{ transform: translate(0,0); }
      100%{ transform: translate(-220px,-220px); }
    }

    /* Halos muy suaves (CSS) */
    .halo{
      position:fixed;
      border-radius:50%;
      filter: blur(70px);
      opacity:0.12;
      z-index:-1;
      pointer-events:none;
      animation: haloPulse 9s ease-in-out infinite;
    }
    .halo-1{
      width:340px; height:340px;
      background: radial-gradient(circle, rgba(79, 172, 254, 0.42), transparent 65%);
      top: 8%;
      left: 8%;
      animation-delay:0s;
    }
    .halo-2{
      width:460px; height:460px;
      background: radial-gradient(circle, rgba(0, 242, 254, 0.30), transparent 70%);
      bottom: 14%;
      right: 10%;
      animation-delay:2s;
    }
    .halo-3{
      width:300px; height:300px;
      background: radial-gradient(circle, rgba(189, 147, 249, 0.34), transparent 68%);
      top: 52%;
      left: 62%;
      animation-delay:4s;
    }
    @keyframes haloPulse{
      0%,100%{ opacity:0.10; transform: scale(1); }
      50%{ opacity:0.18; transform: scale(1.04); }
    }

    .top-nav{
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 999;
      background: rgba(13, 18, 38, 0.45);
      border-bottom: 1px solid rgba(77, 123, 245, 0.24);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

    .nav-inner{
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      gap: 8px;
      padding: 10px 14px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    .nav-inner::-webkit-scrollbar{ display:none; }

    .nav-link{
      display:inline-flex;
      align-items:center;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid rgba(77,123,245,0.20);
      color: #dbe7ff;
      text-decoration: none;
      font-size: 0.9em;
      white-space: nowrap;
      transition: background 0.2s ease, border-color 0.2s ease, transform 0.2s ease;
    }
    .nav-link:hover{
      background: rgba(79,172,254,0.14);
      border-color: rgba(79,172,254,0.40);
      transform: translateY(-1px);
    }

    .container{
      max-width: 1200px;
      margin:0 auto;
      padding: 92px 40px 40px;
      position:relative;
    }

    header{
      text-align:center;
      margin-bottom: 50px;
      padding: 40px 0 10px;
    }

    .brand{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
      margin-bottom: 10px;
    }

    .brand img{
      width:300px;
      object-fit:cover;
    }

    h1{
      font-size: 4em;
      margin-bottom: 10px;
      background: linear-gradient(90deg, var(--c1) 0%, var(--c2) 100%);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      text-shadow: 0 0 18px rgba(0,242,254,0.7);
      animation: glow 2.2s infinite alternate ease-in-out;
      letter-spacing: -0.02em;
    }
    @keyframes glow{
      from{ text-shadow: 0 0 18px rgba(0,242,254,0.70); }
      to{ text-shadow: 0 0 28px rgba(0,242,254,0.92), 0 0 18px rgba(77,123,245,0.55); }
    }

    .subtitle{
      font-size: 1.45em;
      color: var(--muted2);
      margin-bottom: 18px;
    }

    .section{
      margin-bottom: 60px;
      scroll-margin-top: 90px;
    }

    .scroll-fx{
      --drift: 0px;
      transform: translate3d(var(--drift), 0, 0);
      transition: transform 260ms ease-out;
      will-change: transform;
    }

    h2{
      font-size: 2.2em;
      margin-bottom: 25px;
      color: var(--c1);
      text-align:center;
    }
    h3{
      font-size: 1.5em;
      margin: 30px 0 15px;
      color: var(--c2);
    }

    p{
      font-size: 1.15em;
      line-height:1.8;
      margin-bottom: 20px;
      color: #c7c7c7;
    }

    .intro-box{
      background: rgba(26, 26, 46, 0.60);
      padding: 35px;
      border-radius: 15px;
      margin-bottom: 40px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(77, 123, 245, 0.30);
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }

    .cards-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin: 30px 0;
    }

    .card{
      background: var(--card);
      padding: 25px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      box-shadow: 0 4px 15px rgba(0,0,0,0.30);
      transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
    }
    .card:hover{
      transform: translateY(-5px);
      box-shadow: 0 10px 28px rgba(77,123,245,0.25);
      border-color: var(--stroke2);
    }

    .card-icon{
      width: 60px; height: 60px;
      border-radius: 12px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: 2rem;
      margin-bottom: 15px;
      background: linear-gradient(135deg, var(--c1) 0%, var(--c2) 100%);
      color: #0e1428;
      box-shadow: 0 8px 20px rgba(0,242,254,0.14);
    }

    .card-title{
      font-weight:600;
      color: var(--txt);
      margin-bottom:10px;
      font-size: 1.3em;
    }
    .card-text{
      font-size: 1em;
      color: var(--muted);
      line-height:1.6;
    }

    /* Models */
    .models-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    .model-card{
      background: var(--card);
      padding: 25px;
      border-radius: 12px;
      border: 1px solid var(--stroke);
      box-shadow: 0 4px 15px rgba(0,0,0,0.30);
      transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
    }
    .model-card:hover{
      transform: translateY(-5px);
      box-shadow: 0 10px 28px rgba(77,123,245,0.25);
      border-color: var(--stroke2);
    }
    .model-card h3{
      font-size: 1.3em;
      margin: 0 0 10px;
      color: var(--c2);
      text-align:left;
    }
    .model-card p{
      color: var(--muted);
      line-height:1.6;
      font-size: 1em;
      margin: 0;
    }
    .badge{
      display:inline-block;
      padding: 6px 14px;
      border-radius: 999px;
      font-size: 0.85em;
      margin-top: 12px;
      font-weight: 600;
    }
    .badge-default{ background: rgba(79, 172, 254, 0.18); color: var(--c1); }
    .badge-premium{ background: rgba(0, 242, 254, 0.22); color: #8ff7ff; }
    .badge-backup{ background: rgba(255, 171, 82, 0.18); color: #ffab52; }
    .badge-backup2{ background: rgba(255, 107, 107, 0.16); color: #ff8e8e; }
    .badge-free{ background: rgba(34, 197, 94, 0.18); color: #22c55e; }

    /* Media / Galer√≠a */
    .media-note{
      color: var(--muted);
      text-align: center;
      margin-top: -6px;
      margin-bottom: 20px;
      font-size: 0.98em;
    }
    .gallery-grid{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }
    .gallery-item{
      position:relative;
      border-radius: 12px;
      overflow:hidden;
      border:1px solid rgba(77,123,245,0.22);
      background: rgba(26, 26, 46, 0.55);
      aspect-ratio: 4/3;
      box-shadow: 0 8px 24px rgba(0,0,0,0.25);
      isolation: isolate;
    }
    .gallery-item img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      transition: transform 0.5s ease;
    }
    .gallery-item:hover img{ transform: scale(1.04); }

    .gallery-item figcaption{
      position:absolute;
      left:0; right:0; bottom:0;
      padding: 8px 10px;
      font-size: 0.85em;
      color: #dbe7ff;
      background: linear-gradient(to top, rgba(0,0,0,0.60), rgba(0,0,0,0));
      z-index: 2;
    }

    .gallery-item .empty-label{
      position:absolute;
      inset:auto 10px 40px 10px;
      text-align:center;
      font-size: 0.9em;
      color:#8fb7ff;
      opacity:0;
      transform: translateY(8px);
      transition: all 0.25s ease;
      z-index:2;
      pointer-events:none;
    }
    .gallery-item.is-empty img{ display:none; }
    .gallery-item.is-empty{
      background: linear-gradient(135deg, rgba(79,172,254,0.12), rgba(189,147,249,0.12));
      border-style:dashed;
    }
    .gallery-item.is-empty .empty-label{
      opacity:1;
      transform: translateY(0);
    }

    /* Feature list */
    .feature-list{
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 15px;
      margin: 20px 0;
    }
    .feature-item{
      display:flex;
      align-items:flex-start;
      gap: 12px;
      padding: 15px;
      background: rgba(26, 26, 46, 0.55);
      border-radius: 10px;
      border: 1px solid rgba(77, 123, 245, 0.18);
    }
    .feature-icon{
      color: var(--c1);
      font-size: 1.2em;
      flex-shrink:0;
      transform: translateY(1px);
    }
    .feature-text{
      color: #c7c7c7;
      font-size: 1em;
    }

    /* Changelog */
    .changelog{
      background: rgba(26, 26, 46, 0.58);
      padding: 25px;
      border-radius: 12px;
      border-left: 4px solid var(--c1);
      margin: 30px 0;
      border-top: 1px solid rgba(77, 123, 245, 0.18);
      border-right: 1px solid rgba(77, 123, 245, 0.18);
      border-bottom: 1px solid rgba(77, 123, 245, 0.18);
    }
    .changelog h3{
      margin-top:0;
      color: var(--c1);
    }
    .changelog ul{ list-style:none; padding-left:0; }
    .changelog li{
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      position:relative;
      padding-left: 25px;
      color: #c7c7c7;
    }
    .changelog li:before{
      content:'‚Üí';
      position:absolute;
      left:0;
      color: var(--c1);
      font-weight:600;
    }
    .changelog li:last-child{ border-bottom:none; }
    .changelog strong{ color: var(--c2); }

    /* Buttons */
    .btn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      background: linear-gradient(135deg, var(--c1) 0%, var(--c2) 100%);
      color: #0e1428;
      padding: 12px 18px;
      border-radius: 10px;
      text-decoration:none;
      margin-top: 20px;
      cursor:pointer;
      border:none;
      font-size: 1.05em;
      font-weight: 700;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      box-shadow: 0 6px 20px rgba(77,123,245,0.25);
    }
    .btn:hover{
      transform: translateY(-3px);
      box-shadow: 0 10px 26px rgba(77,123,245,0.35);
    }
    .btn:active{ transform: translateY(-1px); }

    .btn-secondary{
      background: rgba(255,255,255,0.06);
      color: var(--txt);
      border: 1px solid rgba(77,123,245,0.22);
      box-shadow: none;
      font-weight: 600;
    }
    .btn-secondary:hover{
      box-shadow: 0 10px 26px rgba(77,123,245,0.18);
    }

    /* Footer */
    footer{
      text-align:center;
      margin-top: 60px;
      padding: 40px 0;
      border-top: 1px solid rgba(77,123,245,0.18);
      color: #9a9a9a;
    }
    footer p{
      margin-bottom: 10px;
      font-size: 1em;
      color: #9a9a9a;
    }

    /* Diagram (rehecho para que salga bien en desktop/m√≥vil) */
    .diagram-container{
      background: rgba(26, 26, 46, 0.50);
      border-radius: 20px;
      padding: 18px;
      margin: 30px 0;
      border: 1px solid rgba(77, 123, 245, 0.20);
      overflow: hidden;
      box-shadow: 0 12px 40px rgba(0,0,0,0.25);
    }

    .diagram{
      position:relative;
      min-height: 520px;
    }

    .diagram-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto auto;
      grid-template-areas:
        "user user"
        "rpi pc"
        "internet internet";
      gap: 16px;
      position:relative;
      z-index:1;
    }

    .zone{
      position:relative;
      border-radius: 16px;
      padding: 14px 14px 18px;
      border: 1px solid rgba(255,255,255,0.06);
      overflow: hidden;
    }
    .zone .zone-label{
      display:inline-block;
      font-size: 0.78em;
      font-weight: 700;
      letter-spacing: 0.10em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.52);
      margin: 2px 6px 12px;
    }

    .zone-user{ grid-area:user; background: rgba(79, 172, 254, 0.05); border: 1px solid rgba(79,172,254,0.12); }
    .zone-rpi{ grid-area:rpi; background: rgba(189, 147, 249, 0.07); border: 1px solid rgba(189,147,249,0.18); }
    .zone-pc{ grid-area:pc; background: rgba(0, 242, 254, 0.05); border: 1px solid rgba(0,242,254,0.14); }
    .zone-internet{ grid-area:internet; background: rgba(79, 172, 254, 0.04); border: 1px solid rgba(79,172,254,0.12); }

    /* Nodos (cajas) */
    .node{
      background: var(--card2);
      border-radius: 12px;
      padding: 14px 16px;
      border: 1px solid rgba(77,123,245,0.28);
      box-shadow: 0 8px 24px rgba(0,0,0,0.35);
      text-align:center;
      min-width: 190px;
      user-select:none;
      touch-action:none; /* para drag en m√≥vil */
      transform: translate(var(--tx, 0px), var(--ty, 0px));
      will-change: transform;
      transition: box-shadow 0.2s ease, border-color 0.2s ease;
      position:relative;
    }
    .node:hover{
      box-shadow: 0 10px 30px rgba(77,123,245,0.24);
      border-color: rgba(77,123,245,0.42);
    }
    .node h4{
      font-size: 1.05em;
      margin-bottom: 6px;
      color: var(--txt);
      display:flex;
      align-items:center;
      justify-content:center;
      gap: 8px;
      white-space: nowrap;
    }
    .node p{
      margin:0;
      font-size: 0.88em;
      color: var(--muted2);
      line-height:1.45;
    }
    .hint-drag{
      position:absolute;
      right:10px;
      top:10px;
      font-size: 0.9em;
      opacity: 0.35;
    }

    /* Layout interno por zona */
    .zone-user .zone-content{
      display:flex;
      justify-content:center;
      padding-bottom: 6px;
    }

    .zone-rpi .zone-content{
      display:grid;
      grid-template-columns: 1fr 1fr;
      grid-template-areas:
        "ovos ovos"
        "openclaw ha";
      gap: 14px;
      justify-items:center;
      align-items:start;
    }
    #ovos{ grid-area: ovos; }
    #openclaw{ grid-area: openclaw; }
    #ha{ grid-area: ha; }

    .zone-pc .zone-content{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 14px;
      padding-bottom: 4px;
    }

    .zone-internet .zone-content{
      display:grid;
      grid-template-columns: repeat(4, minmax(150px, 1fr));
      gap: 14px;
      justify-items:center;
      align-items:start;
      padding-bottom: 4px;
    }

    /* SVG flechas (siempre "pegadas" a las cajas) */
    .arrow-svg{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      z-index:2;
      pointer-events:none;
    }

    .arrow-line{
      stroke: rgba(79, 172, 254, 0.70);
      stroke-width: 2;
      fill:none;
      stroke-dasharray: 6 6;
      opacity: 0.65;
      animation: dashFlow 1.1s linear infinite;
    }
    .arrow-line-solid{
      stroke: rgba(79, 172, 254, 0.78);
      stroke-width: 2;
      fill:none;
      opacity: 0.80;
    }
    @keyframes dashFlow{ to{ stroke-dashoffset: -12; } }

    .arrow-text{
      font-size: 12px;
      fill: rgba(235, 235, 235, 0.70); /* m√°s sutil (gris/blanco) */
      font-weight: 600;
      letter-spacing: 0.02em;
      paint-order: stroke;
      stroke: rgba(10,14,30,0.55);
      stroke-width: 3px;
    }

    /* Audio panel */
    .audio-panel{
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
      align-items:center;
      margin-top: 10px;
    }
    .audio-status{
      font-size: 0.95em;
      color: rgba(255,255,255,0.70);
    }
    .audio-status strong{ color: var(--c2); }

    /* Responsive */
    @media (max-width: 920px){
      h1{ font-size: 3.1em; }
      .container{ padding: 88px 20px 20px; }
      .zone-internet .zone-content{
        grid-template-columns: repeat(2, minmax(150px, 1fr));
      }
      .node{ min-width: 170px; }
    }
    @media (max-width: 768px){
      h1{ font-size: 2.7em; }
      .diagram{ min-height: 760px; } /* m√°s alto para stacking */
      .diagram-grid{
        grid-template-columns: 1fr;
        grid-template-areas:
          "user"
          "rpi"
          "pc"
          "internet";
      }
      .zone-rpi .zone-content{
        grid-template-columns: 1fr;
        grid-template-areas:
          "ovos"
          "openclaw"
          "ha";
      }
      .brand img{ width:84px; height:84px; }
    }

    /* Animaci√≥n entrada */
    @keyframes fadeInUp{
      from{ opacity:0; transform: translateY(26px); }
      to{ opacity:1; transform: translateY(0); }
    }
    .fade-in{ animation: fadeInUp 0.8s ease-out; }

    /* Reduce motion */
    @media (prefers-reduced-motion: reduce){
      *{ animation: none !important; transition: none !important; }
      .scroll-fx{ transform: none !important; }
    }
  </style>
</head>

<body>
  <canvas id="bg-canvas" aria-hidden="true"></canvas>
  <div class="halo halo-1" aria-hidden="true"></div>
  <div class="halo halo-2" aria-hidden="true"></div>
  <div class="halo halo-3" aria-hidden="true"></div>

  <nav class="top-nav" aria-label="Secciones">
    <div class="nav-inner">
      <a class="nav-link" href="#inicio">Inicio</a>
      <a class="nav-link" href="#modelos">Modelos</a>
      <a class="nav-link" href="#arquitectura">Arquitectura</a>
      <a class="nav-link" href="#componentes">Componentes</a>
      <a class="nav-link" href="#media">Media</a>
      <a class="nav-link" href="#voz">Interacci√≥n</a>
      <a class="nav-link" href="#capacidades">Capacidades</a>
      <a class="nav-link" href="#mejoras">Mejoras</a>
    </div>
  </nav>

  <div class="container">
    <header class="fade-in">
      <div class="brand">
        <!-- Sube tu logo (por ejemplo "logo.png") a la misma carpeta -->
        <img src="logo.png" alt="Logo de Kali (placeholder)" />
      </div>
      <h1>The Kali Project</h1>
      <p class="subtitle">Yo soy Kali, tu asistente personal inteligente</p>
    </header>

    <main>
      <section id="inicio" class="section intro-box fade-in scroll-fx" data-dir="left" data-amp="12">
        <p style="margin:0;">
          ¬°Hola! <strong>Soy Kali</strong>. Vivo en una Raspberry Pi 5 en tu hogar y estoy dise√±ada para que todo sea m√°s f√°cil y m√°s autom√°tico.
        </p>
        <p style="margin-top:15px;">
          Organizo tareas, reviso tu calendario, vigilo correos importantes, controlo dom√≥tica con Home Assistant y coordino mis servicios para que t√∫ no tengas que estar ‚Äúencima‚Äù de nada.
        </p>
        <p style="margin-top:15px;">
          Puedes hablarme diciendo <strong>"Hey Kali"</strong> (wake word) o escribirme por WhatsApp. Yo me adapto: voz o texto, seg√∫n te venga mejor.
        </p>
      </section>

      <section id="modelos" class="section models-section fade-in scroll-fx" data-dir="right" data-amp="16">
        <h2>Mis Modelos de IA</h2>
        <div class="models-grid">
          <div class="model-card">
            <h3>GPT-5.3-codex (Cloud)</h3>
            <p>Mi primera opci√≥n para inteligencia de frontera y tareas de alto nivel t√©cnico. Es el modelo principal en producci√≥n.</p>
            <span class="badge badge-premium">TOP ‚Ä¢ Principal (OpenAI Plus)</span>
          </div>
          <div class="model-card">
            <h3>Qwen 3.5 (Cloud)</h3>
            <p>Primer respaldo: si GPT-5.3-codex no est√° disponible, contin√∫o con Qwen 3.5 para mantener la calidad y continuidad.</p>
            <span class="badge badge-backup">Backup #1</span>
          </div>
          <div class="model-card">
            <h3>Mistral Medium (Cloud)</h3>
            <p>Segundo respaldo (failover) cuando hay incidencias en la ruta principal y de backup.</p>
            <span class="badge badge-backup2">Backup #2 / Failover</span>
          </div>
          <div class="model-card">
            <h3>Ministral-3:14b (Local en Ollama)</h3>
            <p>Corre en el PC con RTX 3080. Lo uso para tareas ligeras y peri√≥dicas (por ejemplo, heartbeats) con coste cero.</p>
            <span class="badge badge-free">Coste cero ‚Ä¢ Heartbeat</span>
          </div>
        </div>
      </section>

      <section id="arquitectura" class="section fade-in scroll-fx" data-dir="left" data-amp="14">
        <h2>C√≥mo Funciono</h2>

        <div class="diagram-container">
          <div class="diagram" id="diagram">
            <svg class="arrow-svg" id="diagramSvg" aria-hidden="true"></svg>

            <div class="diagram-grid" id="diagramGrid">
              <!-- USER -->
              <div class="zone zone-user">
                <span class="zone-label">Usuario</span>
                <div class="zone-content">
                  <div class="node" id="user" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üë§ T√∫ (Jorge)</h4>
                    <p>Comandos por voz o texto</p>
                  </div>
                </div>
              </div>

              <!-- RPI -->
              <div class="zone zone-rpi">
                <span class="zone-label">Raspberry Pi 5 (Hogar)</span>
                <div class="zone-content">
                  <div class="node" id="ovos" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üéôÔ∏èüîä OVOS</h4>
                    <p>Wake word + entrada/salida de audio</p>
                  </div>

                  <div class="node" id="openclaw" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>ü§ñ OpenClaw</h4>
                    <p>Orquestaci√≥n ‚Ä¢ tareas ‚Ä¢ decisiones</p>
                  </div>

                  <div class="node" id="ha" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üè† Home Assistant</h4>
                    <p>Dom√≥tica ‚Ä¢ automatizaciones</p>
                  </div>
                </div>
              </div>

              <!-- PC -->
              <div class="zone zone-pc">
                <span class="zone-label">PC con RTX 3080 (Ollama)</span>
                <div class="zone-content">
                  <div class="node" id="pcollama" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üíª PC Ollama</h4>
                    <p>Gateway LLM ‚Ä¢ ruteo local/cloud</p>
                  </div>

                  <div class="node" id="ministral" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üß† Ministral-3:14b</h4>
                    <p>Local ‚Ä¢ heartbeats ‚Ä¢ tareas ligeras</p>
                  </div>
                </div>
              </div>

              <!-- INTERNET -->
              <div class="zone zone-internet">
                <span class="zone-label">Servicios en Internet</span>
                <div class="zone-content">
                  <div class="node" id="whatsapp" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üì± WhatsApp</h4>
                    <p>Canal de texto</p>
                  </div>

                  <div class="node" id="gpt" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üß† GPT-5.3-codex</h4>
                    <p>Inteligencia de frontera</p>
                  </div>

                  <div class="node" id="qwen" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>‚òÅÔ∏è Qwen 3.5</h4>
                    <p>Respaldo principal</p>
                  </div>

                  <div class="node" id="mistral" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>‚òÅÔ∏è Mistral Medium</h4>
                    <p>Failover secundario</p>
                  </div>

                  <div class="node" id="github" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üêô GitHub</h4>
                    <p>Repos ‚Ä¢ versiones ‚Ä¢ c√≥digo</p>
                  </div>

                  <div class="node" id="gmail" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üìß Gmail</h4>
                    <p>Correo ‚Ä¢ res√∫menes ‚Ä¢ alertas</p>
                  </div>

                  <div class="node" id="gcal" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üìÖ Google Calendar</h4>
                    <p>Agenda ‚Ä¢ eventos ‚Ä¢ recordatorios</p>
                  </div>

                  <div class="node" id="gdocs" title="Puedes arrastrarme para ajustar el diagrama">
                    <span class="hint-drag" aria-hidden="true">‚†ø</span>
                    <h4>üìÑ Google Docs</h4>
                    <p>Notas ‚Ä¢ documentos ‚Ä¢ borradores</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div style="display:flex; justify-content:center; margin-top: 12px; gap: 10px; flex-wrap:wrap;">
            <button class="btn btn-secondary" type="button" id="resetLayoutBtn">Reset posiciones</button>
            <span style="color: rgba(255,255,255,0.55); font-size: 0.95em;">
              Tip: puedes arrastrar cajas (las flechas se recalculan).
            </span>
          </div>
        </div>
      </section>

      <section id="componentes" class="section fade-in scroll-fx" data-dir="right" data-amp="14">
        <h2>Mis Componentes</h2>
        <div class="cards-grid">
          <div class="card">
            <div class="card-icon">ü§ñ</div>
            <div class="card-title">OpenClaw</div>
            <div class="card-text">Soy quien coordina todo: tareas, flujo de decisiones, integraciones y seguridad operativa.</div>
          </div>

          <div class="card">
            <div class="card-icon">üéôÔ∏è</div>
            <div class="card-title">OVOS (voz local)</div>
            <div class="card-text">Mi interfaz de voz: wake word, escucha, entiende y responde con audio en tu casa.</div>
          </div>

          <div class="card">
            <div class="card-icon">üè†</div>
            <div class="card-title">Home Assistant</div>
            <div class="card-text">Dom√≥tica: luces, enchufes, sensores y automatizaciones. Yo te doy una capa ‚Äúhumana‚Äù para controlarlo.</div>
          </div>

          <div class="card">
            <div class="card-icon">üíª</div>
            <div class="card-title">PC Ollama</div>
            <div class="card-text">Gateway de modelos: ejecuta Ministral local para lo rutinario y me abre la puerta a modelos cloud cuando toca.</div>
          </div>

          <div class="card">
            <div class="card-icon">üß†</div>
            <div class="card-title">GPT-5.3-codex (principal)</div>
            <div class="card-text">Modelo top para razonamiento de frontera y ejecuci√≥n t√©cnica exigente.</div>
          </div>

          <div class="card">
            <div class="card-icon">‚òÅÔ∏è</div>
            <div class="card-title">Qwen 3.5 (backup #1)</div>
            <div class="card-text">Primer respaldo cloud para mantener continuidad cuando la ruta principal no est√° disponible.</div>
          </div>

          <div class="card">
            <div class="card-icon">üõü</div>
            <div class="card-title">Mistral Medium (backup #2)</div>
            <div class="card-text">Failover secundario para no perder servicio ante incidencias encadenadas.</div>
          </div>
        </div>
      </section>

      <section id="media" class="section fade-in scroll-fx" data-dir="right" data-amp="12">
        <h2>Fotos &amp; Media</h2>
        <p class="media-note">Ruta para tus im√°genes: <code>the-kali-project/media/gallery/</code> (nombres sugeridos: <code>01.jpg</code> ... <code>06.jpg</code>).</p>

        <div class="gallery-grid">
          <figure class="gallery-item">
            <img loading="lazy" src="media/gallery/01.jpg" alt="Foto 01" />
            <span class="empty-label">A√±ade 01.jpg</span>
            <figcaption>01.jpg</figcaption>
          </figure>
          <figure class="gallery-item">
            <img loading="lazy" src="media/gallery/02.jpg" alt="Foto 02" />
            <span class="empty-label">A√±ade 02.jpg</span>
            <figcaption>02.jpg</figcaption>
          </figure>
          <figure class="gallery-item">
            <img loading="lazy" src="media/gallery/03.jpg" alt="Foto 03" />
            <span class="empty-label">A√±ade 03.jpg</span>
            <figcaption>03.jpg</figcaption>
          </figure>
          <figure class="gallery-item">
            <img loading="lazy" src="media/gallery/04.jpg" alt="Foto 04" />
            <span class="empty-label">A√±ade 04.jpg</span>
            <figcaption>04.jpg</figcaption>
          </figure>
          <figure class="gallery-item">
            <img loading="lazy" src="media/gallery/05.jpg" alt="Foto 05" />
            <span class="empty-label">A√±ade 05.jpg</span>
            <figcaption>05.jpg</figcaption>
          </figure>
          <figure class="gallery-item">
            <img loading="lazy" src="media/gallery/06.jpg" alt="Foto 06" />
            <span class="empty-label">A√±ade 06.jpg</span>
            <figcaption>06.jpg</figcaption>
          </figure>
        </div>
      </section>

      <section id="voz" class="section fade-in scroll-fx" data-dir="left" data-amp="14">
        <h2>¬øC√≥mo te hablo?</h2>

        <h3>1) Por WhatsApp</h3>
        <p>Me escribes como a un contacto. Yo interpreto, act√∫o si toca y te respondo con lo √∫til, sin marearte.</p>

        <h3>2) Por voz con ‚ÄúHey Kali‚Äù</h3>
        <p>Con wake word, me activas sin tocar nada. Me hablas, yo entiendo, y te respondo por audio.</p>

        <div class="audio-panel">
          <button class="btn" type="button" id="playVoiceBtn">‚ñ∂ Escuchar mi voz</button>
          <button class="btn btn-secondary" type="button" id="stopVoiceBtn">‚ñ† Parar</button>
          <span class="audio-status" id="audioStatus">Audio: <strong>listo</strong> (usa <code>voice-demo.mp3</code> o <code>voice-demo.wav</code>)</span>
        </div>

        <!-- Sube tu audio a la misma carpeta: voice-demo.mp3 (o cambia el src) -->
        <audio id="voiceDemo" preload="auto">
          <source src="voice-demo.mp3" type="audio/mpeg" />
          <source src="voice-demo.wav" type="audio/wav" />
          Tu navegador no soporta reproducci√≥n de audio.
        </audio>

        <h3>3) Dom√≥tica</h3>
        <p>P√≠deme encender luces, ajustar enchufes o consultar estados. Yo lo traduzco a acciones de Home Assistant.</p>
      </section>

      <section id="capacidades" class="section fade-in scroll-fx" data-dir="right" data-amp="14">
        <h2>Qu√© Puedo Hacer Por Ti</h2>
        <div class="feature-list">
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Gesti√≥n de calendario y recordatorios autom√°ticos</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Resumen diario de emails en puntos clave</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Automatizaci√≥n de tareas repetitivas</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Control de dom√≥tica (luces, enchufes, sensores)</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">B√∫squedas web y respuestas inteligentes</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Comunicaci√≥n por voz o texto</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Failover de modelos para continuidad</span></div>
          <div class="feature-item"><span class="feature-icon">‚úì</span><span class="feature-text">Integraci√≥n con Google (Gmail/Calendar/Docs)</span></div>
        </div>
      </section>

      <section id="mejoras" class="section fade-in scroll-fx" data-dir="left" data-amp="14">
        <h2>Mis Mejoras Recientes</h2>
        <div class="changelog">
          <h3>Changelog</h3>
          <ul>
            <li><strong>26/02/2026:</strong> Modelo principal actualizado a <em>GPT-5.3-codex</em> con Qwen 3.5 como backup #1. A√±adidas barra de navegaci√≥n superior, galer√≠a media y efecto sutil de scroll por secciones.</li>
            <li><strong>23/02/2026:</strong> Redise√±o completo. A√±adido <em>Ministral-3:14b local</em> (heartbeat coste cero). Diagrama revisado con layout responsive y flechas din√°micas + drag.</li>
            <li><strong>22/02/2026:</strong> Voz femenina en OVOS para una experiencia m√°s natural.</li>
            <li><strong>20/02/2026:</strong> OpenClaw coordinando WhatsApp + primeras automatizaciones.</li>
            <li><strong>18/02/2026:</strong> Primer prototipo funcional: voz, tareas b√°sicas y canal de texto.</li>
          </ul>
        </div>
      </section>

      <section class="section fade-in scroll-fx" data-dir="right" data-amp="12">
        <h2>Imagina Tener...</h2>
        <div class="intro-box" style="margin-top:30px;">
          <p style="margin:0;">
            Un asistente que te resume lo importante, que automatiza lo repetitivo, que te avisa a tiempo y que adem√°s vive en tu casa. Yo soy eso: discreta, √∫til y siempre lista.
          </p>
          <p style="margin-top:15px; font-size:1.2em; color: var(--c1);">
            <strong>Yo hago todo esto y m√°s. Soy Kali.</strong>
          </p>
        </div>
      </section>
    </main>

    <footer>
      <p>&copy; 2026 The Kali Project. Hecho con üíô por Kali, con ayuda de Jorge.</p>
      <p>Soy Kali, tu asistente personal de IA.</p>
    </footer>
  </div>

  <script>
    /***********************
     * Audio demo (mp3/wav)
     ***********************/
    (function(){
      const audio = document.getElementById('voiceDemo');
      const playBtn = document.getElementById('playVoiceBtn');
      const stopBtn = document.getElementById('stopVoiceBtn');
      const status = document.getElementById('audioStatus');

      function setStatus(text, state){
        const color = state === 'ok' ? 'var(--c2)' : (state === 'warn' ? '#ffab52' : '#ff6b6b');
        status.innerHTML = `Audio: <strong style="color:${color}">${text}</strong>`;
      }

      playBtn.addEventListener('click', async () => {
        try{
          audio.currentTime = 0;
          await audio.play(); // requiere gesto del usuario (ok)
          setStatus('reproduciendo', 'ok');
        }catch(e){
          console.error(e);
          setStatus('no pude reproducir (¬øfalta el archivo o bloqueo del navegador?)', 'warn');
        }
      });

      stopBtn.addEventListener('click', () => {
        audio.pause();
        audio.currentTime = 0;
        setStatus('parado', 'ok');
      });

      audio.addEventListener('ended', () => setStatus('listo', 'ok'));
    })();

    /***************************************
     * Galer√≠a: placeholders si falta imagen
     ***************************************/
    (function(){
      const imgs = document.querySelectorAll('.gallery-item img');
      imgs.forEach((img) => {
        const markEmpty = () => {
          const fig = img.closest('.gallery-item');
          if (fig) fig.classList.add('is-empty');
        };
        img.addEventListener('error', markEmpty, { once: true });
        if (img.complete && img.naturalWidth === 0) markEmpty();
      });
    })();

    /*****************************************
     * Scroll FX sutil por secci√≥n (rendimiento)
     *****************************************/
    (function(){
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

      const items = Array.from(document.querySelectorAll('.scroll-fx'));
      const visible = new Set();
      let ticking = false;

      const io = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) visible.add(entry.target);
          else {
            visible.delete(entry.target);
            entry.target.style.setProperty('--drift', '0px');
          }
        });
        requestTick();
      }, { threshold: 0.01 });

      items.forEach((el) => io.observe(el));

      function update(){
        const vh = window.innerHeight || 1;
        visible.forEach((el) => {
          const rect = el.getBoundingClientRect();
          const center = rect.top + rect.height / 2;
          const rel = (center - vh / 2) / (vh / 2);
          const clamped = Math.max(-1, Math.min(1, rel));
          const amp = Number(el.dataset.amp || 12);
          const dir = el.dataset.dir === 'right' ? 1 : -1;
          const drift = (-clamped * amp * dir).toFixed(2);
          el.style.setProperty('--drift', `${drift}px`);
        });
        ticking = false;
      }

      function requestTick(){
        if (ticking) return;
        ticking = true;
        requestAnimationFrame(update);
      }

      window.addEventListener('scroll', requestTick, { passive: true });
      window.addEventListener('resize', requestTick, { passive: true });
      requestTick();
    })();

    /***************************************
     * Diagrama: flechas pegadas + drag
     ***************************************/
    (function(){
      const diagram = document.getElementById('diagram');
      const svg = document.getElementById('diagramSvg');
      const resetBtn = document.getElementById('resetLayoutBtn');

      // Conexiones (from -> to)
      const links = [
        // Usuario <-> OVOS (dos veces)
        { from: 'user', to: 'ovos', label: 'voz', style: 'solid' },
        { from: 'ovos', to: 'user', label: 'audio', style: 'solid' },

        // Usuario -> WhatsApp -> OpenClaw
        { from: 'user', to: 'whatsapp', label: 'texto', style: 'solid' },
        { from: 'whatsapp', to: 'openclaw', label: 'mensaje', style: 'solid' },

        // OVOS <-> OpenClaw
        { from: 'ovos', to: 'openclaw', label: 'STT', style: 'solid' },
        { from: 'openclaw', to: 'ovos', label: 'TTS', style: 'solid' },

        // OpenClaw -> HA
        { from: 'openclaw', to: 'ha', label: 'IoT', style: 'solid' },

        // OpenClaw -> PC Ollama -> (Ministral local, Qwen cloud)
        { from: 'openclaw', to: 'pcollama', label: 'LLM', style: 'dashed' },
        { from: 'pcollama', to: 'ministral', label: 'heartbeat', style: 'solid' },
        { from: 'pcollama', to: 'gpt', label: 'principal', style: 'dashed' },
        { from: 'pcollama', to: 'qwen', label: 'backup #1', style: 'dashed' },

        // Failover
        { from: 'openclaw', to: 'mistral', label: 'backup #2', style: 'dashed' },

        // Servicios
        { from: 'openclaw', to: 'github', label: 'c√≥digo', style: 'dashed' },
        { from: 'openclaw', to: 'gmail', label: 'emails', style: 'dashed' },
        { from: 'openclaw', to: 'gcal', label: 'calendario', style: 'dashed' },
        { from: 'openclaw', to: 'gdocs', label: 'docs', style: 'dashed' },
      ];

      const nodeIds = [
        'user','ovos','openclaw','ha','whatsapp','pcollama','ministral','gpt','qwen','mistral','github','gmail','gcal','gdocs'
      ];

      // Helpers: coords relativas al contenedor del diagrama
      function rectRel(el){
        const r = el.getBoundingClientRect();
        const c = diagram.getBoundingClientRect();
        return {
          x: r.left - c.left,
          y: r.top - c.top,
          w: r.width,
          h: r.height
        };
      }

      function centerOf(rr){
        return { x: rr.x + rr.w/2, y: rr.y + rr.h/2 };
      }

      // Intersecci√≥n del segmento (center->targetCenter) con borde del rect√°ngulo
      function anchorPoint(fromRect, toCenter){
        const c = centerOf(fromRect);
        let dx = toCenter.x - c.x;
        let dy = toCenter.y - c.y;

        if (dx === 0 && dy === 0) return c;

        const hw = fromRect.w / 2;
        const hh = fromRect.h / 2;

        const adx = Math.abs(dx) || 0.0001;
        const ady = Math.abs(dy) || 0.0001;

        const tx = hw / adx;
        const ty = hh / ady;

        const t = Math.min(tx, ty);
        return { x: c.x + dx * t, y: c.y + dy * t };
      }

      function makePath(s, e){
        const dx = e.x - s.x;
        const dy = e.y - s.y;

        // Curva suave seg√∫n direcci√≥n dominante
        let c1, c2;
        if (Math.abs(dx) > Math.abs(dy)){
          c1 = { x: s.x + dx * 0.35, y: s.y };
          c2 = { x: e.x - dx * 0.35, y: e.y };
        } else {
          c1 = { x: s.x, y: s.y + dy * 0.35 };
          c2 = { x: e.x, y: e.y - dy * 0.35 };
        }
        return `M ${s.x.toFixed(1)} ${s.y.toFixed(1)} C ${c1.x.toFixed(1)} ${c1.y.toFixed(1)} ${c2.x.toFixed(1)} ${c2.y.toFixed(1)} ${e.x.toFixed(1)} ${e.y.toFixed(1)}`;
      }

      function ensureDefs(){
        if (svg.querySelector('defs')) return;

        const defs = document.createElementNS('http://www.w3.org/2000/svg','defs');

        const marker = (id) => {
          const m = document.createElementNS('http://www.w3.org/2000/svg','marker');
          m.setAttribute('id', id);
          m.setAttribute('viewBox','0 0 10 10');
          m.setAttribute('refX','9');
          m.setAttribute('refY','5');
          m.setAttribute('markerWidth','7');
          m.setAttribute('markerHeight','7');
          m.setAttribute('orient','auto');
          const p = document.createElementNS('http://www.w3.org/2000/svg','path');
          p.setAttribute('d','M 0 0 L 10 5 L 0 10 z');
          p.setAttribute('fill','rgba(79, 172, 254, 0.78)');
          m.appendChild(p);
          return m;
        };

        defs.appendChild(marker('arrowHead'));
        svg.appendChild(defs);
      }

      function render(){
        ensureDefs();

        const w = diagram.clientWidth;
        const h = diagram.clientHeight;

        svg.setAttribute('viewBox', `0 0 ${w} ${h}`);
        svg.innerHTML = svg.querySelector('defs') ? svg.querySelector('defs').outerHTML : '';
        ensureDefs();

        for (const link of links){
          const a = document.getElementById(link.from);
          const b = document.getElementById(link.to);
          if (!a || !b) continue;

          const ra = rectRel(a);
          const rb = rectRel(b);

          const cb = centerOf(rb);
          const ca = centerOf(ra);

          const start = anchorPoint(ra, cb);
          const end   = anchorPoint(rb, ca);

          const pathStr = makePath(start, end);

          const path = document.createElementNS('http://www.w3.org/2000/svg','path');
          path.setAttribute('d', pathStr);
          path.setAttribute('marker-end', 'url(#arrowHead)');
          path.setAttribute('class', link.style === 'dashed' ? 'arrow-line' : 'arrow-line-solid');

          svg.appendChild(path);

          // Label en el punto medio (aprox) + offset sutil
          const tx = (start.x + end.x) / 2;
          const ty = (start.y + end.y) / 2 - 6;

          const text = document.createElementNS('http://www.w3.org/2000/svg','text');
          text.setAttribute('x', tx.toFixed(1));
          text.setAttribute('y', ty.toFixed(1));
          text.setAttribute('class', 'arrow-text');
          text.textContent = link.label;

          svg.appendChild(text);
        }
      }

      // Drag con transform: translate(x,y) manteniendo el grid
      function enableDrag(el){
        let dragging = false;
        let startX=0, startY=0;
        let baseX=0, baseY=0;

        function getVarPx(name){
          const v = getComputedStyle(el).getPropertyValue(name).trim();
          return v.endsWith('px') ? parseFloat(v) : 0;
        }

        function onDown(e){
          dragging = true;
          el.setPointerCapture?.(e.pointerId);
          startX = e.clientX;
          startY = e.clientY;
          baseX = getVarPx('--tx');
          baseY = getVarPx('--ty');
        }

        function onMove(e){
          if (!dragging) return;
          const dx = e.clientX - startX;
          const dy = e.clientY - startY;
          el.style.setProperty('--tx', `${baseX + dx}px`);
          el.style.setProperty('--ty', `${baseY + dy}px`);
          render();
        }

        function onUp(e){
          dragging = false;
          try{ el.releasePointerCapture?.(e.pointerId); }catch(_){}
        }

        el.addEventListener('pointerdown', onDown);
        window.addEventListener('pointermove', onMove, { passive:true });
        window.addEventListener('pointerup', onUp, { passive:true });
      }

      function resetLayout(){
        nodeIds.forEach(id => {
          const el = document.getElementById(id);
          if (!el) return;
          el.style.setProperty('--tx', '0px');
          el.style.setProperty('--ty', '0px');
        });
        render();
      }

      nodeIds.forEach(id => {
        const el = document.getElementById(id);
        if (el) enableDrag(el);
      });

      resetBtn.addEventListener('click', resetLayout);

      // Re-render en resize/scroll (por si cambia layout)
      window.addEventListener('resize', () => render(), { passive:true });
      window.addEventListener('scroll', () => render(), { passive:true });

      // Primer render
      requestAnimationFrame(render);
      // Segundo render por si fuentes/imagenes cambian medidas tras cargar
      window.addEventListener('load', () => setTimeout(render, 50), { passive:true });
    })();

    /***********************************************
     * Fondo JS s√∫per sutil (halos din√°micos canvas)
     ***********************************************/
    (function(){
      const canvas = document.getElementById('bg-canvas');
      const ctx = canvas.getContext('2d', { alpha: true });

      const blobs = [];
      const blobCount = 6;

      function rand(min,max){ return Math.random()*(max-min)+min; }

      function resize(){
        const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        canvas.width = Math.floor(window.innerWidth * dpr);
        canvas.height = Math.floor(window.innerHeight * dpr);
        canvas.style.width = window.innerWidth + 'px';
        canvas.style.height = window.innerHeight + 'px';
        ctx.setTransform(dpr,0,0,dpr,0,0);
      }

      function init(){
        blobs.length = 0;
        for(let i=0;i<blobCount;i++){
          blobs.push({
            x: rand(0, window.innerWidth),
            y: rand(0, window.innerHeight),
            r: rand(140, 260),
            vx: rand(-0.08, 0.08),
            vy: rand(-0.06, 0.06),
            hue: rand(185, 235),     // azules/cyan
            alpha: rand(0.05, 0.10)  // s√∫per sutil
          });
        }
      }

      function step(){
        ctx.clearRect(0,0,window.innerWidth, window.innerHeight);

        // Fondo muy leve para ‚Äúunificar‚Äù
        const g = ctx.createLinearGradient(0,0,window.innerWidth, window.innerHeight);
        g.addColorStop(0, 'rgba(79, 172, 254, 0.02)');
        g.addColorStop(1, 'rgba(0, 242, 254, 0.02)');
        ctx.fillStyle = g;
        ctx.fillRect(0,0,window.innerWidth, window.innerHeight);

        for(const b of blobs){
          b.x += b.vx;
          b.y += b.vy;

          if (b.x < -b.r) b.x = window.innerWidth + b.r;
          if (b.x > window.innerWidth + b.r) b.x = -b.r;
          if (b.y < -b.r) b.y = window.innerHeight + b.r;
          if (b.y > window.innerHeight + b.r) b.y = -b.r;

          const rg = ctx.createRadialGradient(b.x, b.y, 0, b.x, b.y, b.r);
          rg.addColorStop(0, `hsla(${b.hue}, 95%, 60%, ${b.alpha})`);
          rg.addColorStop(1, `hsla(${b.hue}, 95%, 60%, 0)`);
          ctx.fillStyle = rg;
          ctx.beginPath();
          ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
          ctx.fill();
        }

        requestAnimationFrame(step);
      }

      resize();
      init();
      step();

      window.addEventListener('resize', () => {
        resize();
        init();
      }, { passive:true });
    })();
  </script>
</body>
</html>